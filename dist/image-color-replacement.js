var ImageReplacer,ImageReplacerDirective;ImageReplacer=function(){function e(e){this.original=e,this.canvas=n(e),this.ctx=t(this.canvas),this.drawed=r(this.ctx,e)}var t,r,n,a,i,l;return e.original=null,e.canvas=null,l=function(e){var t,r,n,a,i;if(e=e.replace("#",""),t=[],6===e.length)for(i=[0,1,2],n=0,a=i.length;a>n;n++)r=i[n],t.push(parseInt(e.substr(2*r,2),16));return t},n=function(e){var t;return t=document.createElement("canvas"),t.width=e.width,t.height=e.height,t},t=function(e){return e?e.getContext("2d"):void 0},r=function(e,t){var r;return e.drawImage(t,0,0,t.width,t.height),r=e.getImageData(0,0,t.width,t.height)},i=function(e,t){return Math.abs(e-t)},a=function(e,t,r){return e>t?t+r>e:e>t-r},e.prototype.replaceColors=function(e){var t,r,n,a,o,c;if(e){if(e.length>0)for(r=0;r<this.drawed.data.length;){for(n=0,a=e.length;a>n;n++)o=e[n],t=l(o.from),c=l(o.to),o.tolerance||(o.tolerance=10),i(this.drawed.data[r+0],t[0])<=o.tolerance&&i(this.drawed.data[r+1],t[1])<=o.tolerance&&i(this.drawed.data[r+2],t[2])<=o.tolerance&&(this.drawed.data[r+0]=c[0],this.drawed.data[r+1]=c[1],this.drawed.data[r+2]=c[2]);r+=4}this.ctx.putImageData(this.drawed,0,0)}return!0},e.prototype.replaceHex=function(e){var t,r,n,a;if(t=[],e)for(n=0,a=e.length;a>n;n++)r=e[n],t.push([l(r.from),l(r.to)]);return t},e.prototype.toDataURL=function(e){var t;return null==e&&(e="image/png"),t=this.canvas.toDataURL(e),this.original=null,this.canvas=null,this.ctx=null,this.drawed=null,t},e}(),"undefined"!=typeof angular&&null!==angular&&(ImageReplacerDirective=function(){function e(){var e;return e={restrict:"A",link:t,scope:{colorReplace:"=",ngSrc:"@?"}}}var t,r;return t=function(e,t,n,a){return this.original=new Image,null!=t[0].src&&(this.original.src=t[0].src),null!=e.ngSrc&&(this.original.src=e.ngSrc),null!=this.original.src?(t[0].style.display="none",r(this.original,e.colorReplace,t[0]),e.$watchCollection("colorReplace",function(e){return function(n,a){return null!=n?(t[0].style.display="none",r(e.original,n,t[0])):void 0}}(this))):void 0},r=function(e,t,r){var n;return n=new Image,n.crossOrigin="anonymous",n.onload=function(e){return function(){var e;return e=new ImageReplacer(n),e.replaceColors(t),r.src=e.toDataURL(),r.style.display=null}}(this),n.src=e.src},e}(),ImageReplacerDirective.$inject=[],angular.module("color-replace",[]),angular.module("color-replace").directive("colorReplace",ImageReplacerDirective));